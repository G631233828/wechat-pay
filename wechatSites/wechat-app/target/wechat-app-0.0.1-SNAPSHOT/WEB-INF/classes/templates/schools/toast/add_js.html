<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>

	<div th:fragment="ztree_js">
		<script th:inline="javascript">
       function ajaxDataFilter(treeId, parentNode, responseData) {
        if (responseData) {
          for(var i =0; i < responseData.length; i++) {
              console.log(responseData[i].name)
        	  // responseData[i].name += "_filter";
          }
        }
        return responseData;
    };
	var setting = {
			check: {
				enable: true
			},
			async:{
			 enable:true,
			 url:[[@{/}]]+"asyncTree",
			 dataFilter: ajaxDataFilter,
			 autoParam:["id","toastid"]
			},
			data: {
				key: {
					title: "title"
				},
				simpleData: {
					enable: true
				}
			},
			callback: {
				onCheck: onCheck
			},
		};
	var zNodes =[[${zNodes}]];
	console.log(zNodes);
    function onCheck(e,treeId,treeNode){
		var treeObj=$.fn.zTree.getZTreeObj("tree"),
        nodes=treeObj.getCheckedNodes(true),
		 // nodes = treeObj.getNodesByParam("title", "child", null);
        v="";
		x="";
		
		if(nodes==0){
			 $("#selectText").attr("value",v);	
	         $("#selectIds").attr("value",x);			 
		}
        for(var i=0;i<nodes.length;i++){
	    if(!nodes[i].isParent){
		v+=nodes[i].name + ",";
		x+=nodes[i].id + ",";
		}
		  $("#selectText").attr("value",v);	
          $("#selectIds").attr("value",x);			 
		 }
    }
	$(document).ready(function(){
		$.fn.zTree.init($("#tree"), setting, zNodes);
	});
    </script>
	</div>

</body>
</html>